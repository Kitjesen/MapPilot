# 故障排除指南

## 连接问题

### "机器人未响应，请检查网络连接"
**原因：** App 无法通过网络到达机器人的 gRPC 端口。

**解决步骤：**
1. 确认手机/电脑与机器人在**同一局域网**
2. 检查机器人是否已启动（状态灯是否亮起）
3. 在手机浏览器中访问 `http://<机器人IP>:50051` 验证连通性
4. 检查防火墙是否阻挡了 50051 端口
5. 尝试重启机器人的 `grpc_gateway` 服务

### "操作超时，请重试"
**原因：** 请求发出但机器人未在规定时间内响应。

**解决步骤：**
1. 检查网络延迟（WiFi 信号是否稳定）
2. 进入 设置 → 连接超时，将超时时间从 5 秒增加到 10 秒
3. 如果频繁超时，检查机器人 CPU 负载是否过高

### 自动扫描找不到机器人
**原因：** 网络隔离或 mDNS 被禁用。

**解决步骤：**
1. 确认在同一子网（如 192.168.1.x）
2. 尝试手动输入 IP 连接
3. 在路由器中检查是否启用了 AP 隔离

---

## OTA 更新问题

### "预检查未通过: 磁盘空间不足"
**解决：** 登录机器人终端，清理 `/tmp` 和旧的备份文件：
```bash
ssh user@<robot-ip>
sudo rm -rf /tmp/ota_staging/*
```

### "预检查未通过: 电量不足"
**解决：** 为机器人充电至 30% 以上再重试。

### 上传到一半断网
**解决：** 重新连接后，点击"重试"按钮。App 会尝试从断点继续上传。

### "安全检查未通过: 机器人需进入维护模式"
**原因：** 需要重启的固件更新，机器人必须停止运动。

**解决：** 
1. 确保没有正在执行的任务
2. App 会自动尝试让机器人坐下
3. 如果自动操作失败，手动进入控制页面让机器人坐下

### "固件应用失败"
**解决步骤：**
1. 检查机器人日志（设置 → 导出机器人日志）
2. 确认上传的固件与机器人硬件版本兼容
3. 尝试重新下载并部署

---

## 控制问题

### 摇杆无响应
**解决步骤：**
1. 确认已获取控制权（"获取租约"按钮显示为"释放租约"）
2. 检查机器人是否处于可控制模式（非急停/充电状态）
3. 释放租约后重新获取

### "权限不足"
**原因：** 另一个 App 或终端持有控制权。

**解决：** 等待对方释放租约，或在机器人终端强制释放。

### 急停后无法恢复
**解决步骤：**
1. 在控制页面点击"恢复"按钮
2. 如果无法恢复，重启机器人的运动控制服务
3. 硬急停需要物理复位

---

## 相机问题

### 视频画面黑屏
**解决步骤：**
1. 确认机器人相机硬件正常
2. 检查 WebRTC 服务是否启动
3. 在 Android 上确保已授予相机和麦克风权限
4. 尝试切换前/后相机

### 视频卡顿
**解决：** 
1. 检查 WiFi 信号强度
2. 降低视频分辨率（如有设置选项）
3. 靠近路由器或使用 5GHz 频段

---

## 通用问题

### App 闪退
**解决步骤：**
1. 确认 App 为最新版本
2. 清除 App 缓存（设置 → 数据与存储 → 清除缓存）
3. 重新安装 App
4. 导出日志并联系技术支持

### 如何导出日志
1. 进入 设置 → 导出机器人日志
2. 选择日志类型和时间范围
3. 点击导出，通过微信/邮件发送给技术支持

### 如何查看版本信息
进入 设置 → 版本信息，可以看到 App 版本、Git 提交、机器人固件版本等信息。
点击"一键复制版本信息"可快速将信息发送给技术支持。

---

## 联系技术支持

- 邮箱: support@dasuan.com
- 微信: 扫描 App 内"反馈与支持"页面的二维码
- 提交工单时请附带：版本信息截图 + 导出的日志文件
